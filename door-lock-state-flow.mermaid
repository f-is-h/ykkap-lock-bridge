graph TD
    A[開始] --> B{ドアロックの状態変化}
    B -->|操作なし| C{変更元}
    B -->|開閉操作あり| D{入室か退室か}
    
    C -->|自プログラム| E[状態自動同期]
    C -->|その他:<br>壁スイッチ/他アプリ/手動| F[定期的に状態を確認し更新]
    
    D -->|退室| G[短時間内に状態を確認し同期]
    D -->|入室| H[短時間内に状態を確認し同期]
    
    E --> I[終了]
    F --> I
    G --> I
    H --> I